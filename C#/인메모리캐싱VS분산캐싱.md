# ASP.NET Core 에서 인메모리 캐싱과 분산 캐싱의 차이점
인메모리 캐싱(In-Memory Caching) 및 분산 캐싱(Distributed Caching)은 ASP.NET Core에서 사용되는 두 가지 일반적인 캐싱 전략으로 <br/>
데이터베이스와 같이 느린 데이터 소스에서 반복적으로 가져오는 대신 자주 액세스하는 데이터를 캐시에 저장하여 애플리케이션 성능 및 확장성을 향상시킨다.<br/>
다음은 이러한 두 가지 유형의 캐싱 간의 차이점에 대한 분석이다. <br/>
쉽게 말해 메모리DB를 사용하는데 웹앱의 메모리를 사용하는 것과 따로 메모리DB를 사용하는 것인듯 하다 <br/>
# ASP.NET Core에서의 인메모리 캐싱
인메모리 캐싱은 앱이 실행중인 웹 서버의 메모리에 캐시된 데이터를 저장하는 것을 말한다. <br/>
이러한 캐싱은 외부 호출 없이 앱에서 직접 액세스할 수 있으므로 매우 빠르다. <br/>

![image](https://github.com/user-attachments/assets/e0ca385c-b059-4c2e-82e0-757be65da57c)
# 설정 및 구성
## 캐시 공급자
분산 캐싱 솔루션은 없지만 ASP.NET Core에는 인메모리 캐시 공급자가 내장되어 있다.
## 캐시 구성
앱의 프로세스 내에서 동작함으로 최소한의 구성만 해주면 된다. <br/>
Program.cs 의 구성에서 서비스 컬렉션에 추가해야 한다. <br/>
IMemoryCache를 활용한다. <br/>

## 인메모리 캐싱 장점
### 속도 
데이터가 애플리케이션의 메모리에 직접 저장되기 때문에 액세스 시간이 매우 빠르다. <br/>
### 성능 향상 
특히 자주 액세스하는 데이터의 경우 느린 데이터베이스에서 데이터를 검색할 필요성을 줄인다. <br/>
### 편의성 
ASP.NET Core 프레임워크내에 쉽게 통합되고 추가 인프라가 필요없다. <br/>

## 인메모리 캐싱 단점
### 확장성
데이터는 앱이 실행 중인 서버의 메모리에 저장되기 때문에 분산 캐싱과 달리 클라우드 환경에서 자동으로 확장되지 않는다. <br/>
### 데이터 변동성
앱이 다시 시작되거나 충돌하는 경우 메모리 내 캐시의 데이터가 손실될 수 있다. <br/>
이러한 일은 분산 캐싱 솔루션에서는 발생하지 않는다. <br/>
## 인메모리 캐싱 사용 사례
인메모리 캐싱은 일반적으로 캐시 무효화가 문제가 되지 않고, 설정 편의성이 우선 순위인 소규모 또는 단일 서버 프로그램에 사용된다. <br/>
단일 서버 또는 각 서버가 자체 격리된 캐시를 안전하게 가질 수 있는 인스턴스에 배포된 앱 <br/>
대기 시간이 중요한 요소이고 캐시된 데이터에 최대한 빨리 액세스해야 하는 상황<br/>
작업 부하와 데이터 크기를 예측할 수 있는 환경에서는 서버 메모리가 오버로드될 위험없이 효율적인 메모리 관리가 가능 <br/>

## 사용
### 캐시 액세스
생성자 주입을 통해 컨트롤러 또는 서비스에서 캐시로 액세스 할 수 있다. <br/>
ASP.NET Core의 DI 컨테이너는 캐시된 항목을 설정하고 검색할 수 있는 IMemoryCache 인스턴스를 제공한다. <br/>
### 데이터 저장
Set, CreateEntry 또는 확장 메서드인 GetOrCreate와 같은 메서드를 사용한다. <br/>
데이터와 키를 제공하고 필요에 따라 만료 시간과 같은 캐시 옵션을 설정할 수 있다. <br/>
### 데이터 검색
Get 메서드로 키를 제공하여 데이터를 검색할 수 있다. 키가 있다면 캐시된 데이터를 가져오며 없으면 null을 넘긴다. <br/>
GetOrCreate 메서드는 찾는 데이터가 없으면 만드는 기능이다. <br/>
### 옵션
#### Absolute Expiration(절대 만료)
사용에 관계없이 캐시 항목이 만료되는 시간을 설정한다. <br/>
#### Sliding Expiration(슬라이딩 만료)
지정된 기간 내에 데이터에 액세스하는 경우 만료 시간을 연장한다. <br/>
지정된 기간 동안 사용하지 않을 경우 만료되어야 하는 경우에 유용한다. <br/>
#### Priority (우선권)
메모리 압력으로 인해 발생하는 정리에 대해 유지 우선권을 정하는 것이다. <br/>
Memory Pressure(메모리 압력) <br/>
인메모리 캐싱은 서버에서 사용 가능한 메모리에 직접적인 영향을 받는다.<br/>
ASP.NET Core는 설정된 우선 순위에 따라 메모리가 부족한 상황에서 캐시 항목을 제거할 수 있다.<br/>
Manual Eviction(수동 축출) <br/>
개발자는 캐시된 데이터를 무효화하는 데이터베이스 변경과 같은 특정 조건이 충졸될 때 캐시에서 수동으로 지울 수 있다.

<hr/>

# ASP.NET Core에서의 분산 캐싱
ASP.NET Core에서 분산 캐싱은 여러 서버 또는 인스턴스에서 공유되는 캐시에 데이터를 저장하여 성능과 확장성을 향상시키는 기능이다<br/>
이는 앱이 부하 분산된 클러스터에 배포되거나 물리적으로 분리되어 있는 환경에서 유용하다. <br/>
![image](https://github.com/user-attachments/assets/b634d43b-12e5-4c3a-bab1-ecdc5b51cfef)
# 설정 및 구성
## 분산 캐시 공급자
ASP.NET Core는 Redis, SQL Server 및 NCache를 포함한 여러 분산 캐시 공급자를 지원한다. <br/>
Redis는 성능과 기능으로 인해 인기있는 선택이다. <br/>
## 캐시 구성
앱의 구성 파일(appsettings.json) 또는 코드를 통해 캐시 서비스를 설정한다. <br/>



출처 : <br/>
https://dotnettutorials.net/lesson/difference-between-in-memory-caching-and-distributed-caching-in-asp-netcore/ <br/>

<hr/>
