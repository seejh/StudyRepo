# DB 성능 개선
일단 이 글은 DB 중에서도 MySQL을 기준으로 작성되어 있다. 이 글을 작성한 필자가 MySQL을 기준으로 설명하고 있기 때문이다.

## DB 성능 개선 방법
DB에 부하가 걸렸을 때 성능을 개선하는 방법은 다양하다 주로 아래와 같다.
* SQL 튜닝
* 캐싱 서버 활용(Redis 등)
* 레플리케이션 (Master/Slave)
* 샤딩
* 스케일업(CPU, Memory, SSD 등 하드웨어 업그레이드)

## SQL 튜닝을 먼저 고려해야 한다.
1. SQL 튜닝을 제외한 나머지 방법은 추가적인 시스템을 구축해야 한다. 따라서 금전적, 시간적 비용이 추가적으로 발생한다.
   조금 더 복잡해진 시스템 구조로 인해 관리 비용이 늘어난다. 그에 비해 SQL 튜닝은 기존의 시스템 변경없이 성능을 개선할 수 있다.
2. 근본적인 문제를 해결하는 방법이 SQL 튜닝일 가능성이 높다. SQL 자체가 비효율적으로 작성됐다면 아무리 시스템적으로 성능을 개선한다 하더라도 한계가 있다.
   하지만 SQL 튜닝을 통해 기본적으로 성능을 향상시킨다면 시스템적인 성능 개선이 필요없거나 훨씬 간단한 개선으로 큰 성능 개선 효과를 얻을 수 있다.
   
요약하자면, DB 성능 개선 방법들 중 가장 가성비가 좋고 기본적으로 깔고 가야할 것이 SQL 튜닝이다.

## DB 구조 파악 
어떤 부분에서 DB의 성능을 많이 잡아 먹는지, 어떤 요인이 주로 문제를 일으키는지 파악할 수 있어야 한다.
그 원인을 파악하기 위해서 DB의 구조를 알아야 한다. <br/>
아래는 MySQL 아키텍처를 간단히 표현한 것이고 쿼리를 실행하면 어떻게 수행되는지 알아본다. <br/>
![image](https://github.com/user-attachments/assets/d78591d7-6191-4c78-8155-4d310058001b) <br/>
1. 클라이언트가 DB에 SQL 요청을 보낸다.
2. MySQL 엔진에서 옵티마이저가 SQL 문을 분석한 뒤 빠르고 효율적으로 데이터를 가져올 수 있는 계획을 세운다.
   (어떤 순서로 테이블에 접근할 지, 인덱스를 사용할 지, 어떤 인덱스를 사용할 지 등을 결정)
3. 옵티마이저가 세운 계획을 바탕으로 스토리지 엔진에서 데이터를 가져온다.
4. MySQL 엔진에서 정렬, 필터링 등의 마지막 처리를 한 뒤에 클라이언트에게 SQL 결과를 응답한다.

쿼리를 실행하면 위의 순서대로 진행이 되며 주로 성능상 문제가 되는 지점이 2지점과 3지점이다. <br/>
2지점에서 옵티마이저가 계획을 잘 세울 수 있도록 SQL 튜닝이 필요하다. <br/>
3지점에서는 데이터를 찾기가 어려워서 오래 걸리거나, 가져올 데이터의 양이 너무 많아서 오래 걸린다. 
SQL 튜닝의 핵심은 이 지점에서 데이터를 찾기 쉽게, 더 적은 데이터를 참조하게 바꾸는 것이다.



출처 : <br/>
https://www.youtube.com/watch?v=vbatA68GL1I&list=PLtUgHNmvcs6rJBDOBnkDlmMFkLf-4XVl3&index=4 <br/>
<hr/><br/><br/>








